<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/admin}">
<head>
  <title layout:fragment="title">вЈёВёю В╣┤ьЁїЖ│авдг Ж┤ђвдг</title>
</head>
<body>
<main layout:fragment="content" class="admin-content-area">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="admin-section-title mb-0">вЈёВёю В╣┤ьЁїЖ│авдг Ж┤ђвдг</h2>
    <span th:text="'вЈёВёю ID: ' + ${book.bookId}"></span>
  </div>

  <div class="mb-4">
    <h5>­ЪЊў ьўёВъг ВЌ░Ж▓░вљю В╣┤ьЁїЖ│авдг </h5>
    <ul class="list-group">
      <li th:each="cat1 : ${bookCategories}" class="list-group-item">
        <span th:text="${cat1.categoryName}"></span>

        <span th:if="${cat1.children}">
        <span th:each="cat2 : ${cat1.children}">
          &nbsp;&gt;&nbsp;<span th:text="${cat2.categoryName}"></span>

          <span th:if="${cat2.children}">
            <span th:each="cat3 : ${cat2.children}">
              &nbsp;&gt;&nbsp;<span th:text="${cat3.categoryName}"></span>

              <span th:if="${cat3.children}">
                <span th:each="cat4 : ${cat3.children}">
                  &nbsp;&gt;&nbsp;<span th:text="${cat4.categoryName}"></span>

                  <span th:if="${cat4.children}">
                    <span th:each="cat5 : ${cat4.children}">
                      &nbsp;&gt;&nbsp;<span th:text="${cat5.categoryName}"></span>
                    </span>
                  </span>

                </span>
              </span>

            </span>
          </span>

        </span>
      </span>
      </li>
    </ul>

    <p th:if="${#lists.isEmpty(bookCategories)}" class="text-muted">вЊ▒вАЮвљю В╣┤ьЁїЖ│авдгЖ░ђ ВЌєВіхвІѕвІц.</p>
  </div>


  <div class="mb-4">
    <h5>РЮї ВѓГВаю вўљвіћ ВѕўВаЋьЋа В╣┤ьЁїЖ│авдг</h5>
    <ul class="list-group">
      <li th:each="cat : ${flatBookCategory}" class="list-group-item d-flex justify-content-between align-items-center">
        <span th:text="${cat.categoryName}"></span>

        <div class="d-flex gap-2 align-items-center">
          <!-- РюЁ ВѕўВаЋ ьЈ╝ -->
          <form th:action="@{/admin/book/{bookId}/category/edit(bookId=${bookId})}" method="post" class="d-flex gap-1 align-items-center">
            <input type="hidden" name="categoryId" th:value="${cat.categoryId}" />
            <select name="newCategoryId" class="form-select form-select-sm w-auto" required>
              <option value="">-- ВЃѕвАюВџ┤ В╣┤ьЁїЖ│авдг ВёаьЃЮ --</option>
              <option th:each="c : ${categoryList}"
                      th:value="${c.categoryId}"
                      th:text="${c.categoryName}">
              </option>
            </select>
            <button type="submit" class="btn btn-sm btn-outline-secondary">ВѕўВаЋ</button>
          </form>

          <!-- РЮї ВаюЖ▒░ ьЈ╝ -->
          <form th:action="@{/admin/book/{bookId}/category/remove(bookId=${bookId})}" method="post" class="d-inline">
            <input type="hidden" name="categoryId" th:value="${cat.categoryId}" />
            <button type="submit" class="btn btn-sm btn-outline-danger"
                    onclick="return confirm('ВЮ┤ В╣┤ьЁїЖ│авдгвЦ╝ ВаюЖ▒░ьЋўВІюЖ▓аВіхвІѕЖ╣ї?');">ВаюЖ▒░</button>
          </form>
        </div>
      </li>
    </ul>

    <p th:if="${#lists.isEmpty(flatBookCategory)}" class="text-muted">ВѓГВаю Ж░ђвіЦьЋю В╣┤ьЁїЖ│авдгЖ░ђ ВЌєВіхвІѕвІц.</p>
  </div>

  <div class="mb-4">
    <h5>РъЋ В╣┤ьЁїЖ│авдг ВХћЖ░ђ</h5>
    <form th:action="@{/admin/book/{bookId}/category/register(bookId=${bookId})}" method="post" class="d-flex align-items-center gap-2">
      <select name="categoryId" class="form-select w-auto" required>
        <option value="">-- В╣┤ьЁїЖ│авдг ВёаьЃЮ --</option>
        <option th:each="cat : ${categoryList}" th:value="${cat.categoryId}" th:text="${cat.categoryName}"></option>
      </select>
      <button type="submit" class="btn btn-sm btn-outline-primary">+ ВХћЖ░ђ</button>
    </form>
  </div>
</main>
</body>
</html>
