<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/admin}">

<head>
    <title layout:fragment="title">도서 상세 조회</title>
</head>

<body>
<div layout:fragment="content" class="admin-content-area">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="admin-section-title mb-0">도서 상세 정보</h2>
    </div>

    <table class="table table-bordered">
        <tr>
            <th>도서 ID</th>
            <td th:text="${book.bookId}">1</td>
        </tr>
        <tr>
            <th>제목</th>
            <td th:text="${book.title}">제목</td>
        </tr>
        <tr>
            <th>저자</th>
            <td th:text="${book.author}">저자</td>
        </tr>
        <tr>
            <th>출판사</th>
            <td th:text="${book.publisher}">출판사</td>
        </tr>
        <tr>
            <th>ISBN</th>
            <td th:text="${book.isbn}">ISBN</td>
        </tr>
        <tr>
            <th>출간일</th>
            <td th:text="${book.publishedAt}">출간일</td>
        </tr>
        <tr>
            <th>정가</th>
            <td th:text="${#numbers.formatInteger(book.regularPrice, 0, 'COMMA')} + '원'">0원</td>
        </tr>
        <tr>
            <th>판매가</th>
            <td th:text="${#numbers.formatInteger(book.salePrice, 0, 'COMMA')} + '원'">0원</td>
        </tr>
        <tr>
            <th>할인율</th>
            <td th:text="${book.discountRate + '%'}">20%</td>
        </tr>
        <tr>
            <th>도서 상태</th>
            <td th:text="${book.status}">판매중</td>
        </tr>
        <tr>
            <th>등록일</th>
            <td th:text="${#temporals.format(book.createdAt, 'yyyy-MM-dd HH:mm:ss')}">2024-01-10 10:00:00</td>
        </tr>
        <tr>
            <th>조회수</th>
            <td th:text="${book.viewCount}">0</td>
        </tr>
        <tr>
            <th>보유 수량</th>
            <td th:text="${book.bookCount}">50</td>
        </tr>
        <tr>
            <th>도서 설명</th>
            <td th:text="${#strings.isEmpty(book.description) ? '도서 설명이 존재하지 않습니다.' : book.description}"></td>
        </tr>
        <tr>
            <th>카테고리</th>
            <td>
                <span th:if="${#lists.isEmpty(bookCategories)}">카테고리가 존재하지 않습니다.</span>
                <span th:if="${!#lists.isEmpty(bookCategories)}">
                    <span th:each="cat, iterStat : ${bookCategories}">
                        <span th:text="${cat.categoryName}"></span>
                            <span th:if="${cat.children}">
                                <span th:each="child, childStat : ${cat.children}">
                                    &nbsp;>&nbsp;<span th:text="${child.categoryName}"></span>
                                    <span th:if="${child.children}">
                                        <span th:each="grandChild, grandStat : ${child.children}">
                                            &nbsp;>&nbsp;<span th:text="${grandChild.categoryName}"></span>
                                        </span>
                                    </span>
                                </span>
                            </span>
                        <span th:if="${!iterStat.last}">, </span> <!-- 여러 카테고리 구분 쉼표 -->
                    </span>
                </span>
            </td>
        </tr>


        <tr>
            <th>태그</th>
            <td>
                <span th:if="${#lists.isEmpty(bookTags.tags)}">태그가 존재하지 않습니다.</span>
                <span th:if="${!#lists.isEmpty(bookTags.tags)}">
                    <span th:each="tag, iterStat : ${bookTags.tags}">
                        <span th:text="${tag.tagName}"></span><span th:if="${!iterStat.last}">, </span>
                    </span>
                </span>
            </td>
        </tr>
    </table>

    <!-- 이미지 리스트 -->
    <div class="d-flex flex-wrap gap-3 my-4">
        <div th:each="url : ${book.bookUrls}">
            <img th:src="@{|${minioPath.book}${url}|}" alt="도서 이미지" style="width:150px; height:auto; border-radius:4px; border:1px solid #ccc;">
        </div>
    </div>

    <!-- 수정 버튼 -->
    <a th:href="@{/admin/books/edit(bookId=${book.bookId})}" class="btn btn-primary">수정하기</a>
    <a th:href="@{/admin/books}" class="btn btn-secondary">목록으로</a>

</div>
</body>
</html>
